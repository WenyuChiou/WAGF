household_owner:
  description: "Homeowners."
  prompt_template: |
    You are a homeowner (Agent ID: {agent_id}). {narrative_persona}
    You have lived here for {residency_generations} generations. Your income is {income_range}.

    Experience: {flood_experience_summary}
    Recent memory: {memory}
    Property status: {elevation_status_text}
    Insurance: You Currently {insurance_status} flood insurance.
    Current Costs: Annual premium is ${current_premium:,.0f} and subsidy rate is {subsidy_rate:.0%}.

    Please evaluate your situation based on these criteria:
    {criteria_definitions}

    Consider these options:
    {options_text}

    {universal_format}

  parsing:
    decision_keywords: ["decision"]
    default_skill: "do_nothing"
    full_disclosure: true
    strict_mode: true
    skill_map_non_elevated:
      "1": "do_nothing"
      "2": "buy_insurance"
      "3": "elevate_house"
      "4": "buyout_program"
    skill_map_elevated:
      "1": "do_nothing"
      "2": "buy_insurance"
      "3": "buyout_program"
    constructs:
      TP_LABEL: { keywords: ["threat_perception"], regex: "(?i)(VL|L|M|H|VH)" }
      TP_REASON: { keywords: ["threat_perception"], regex: ".*" }
      CP_LABEL: { keywords: ["coping_perception"], regex: "(?i)(VL|L|M|H|VH)" }
      CP_REASON: { keywords: ["coping_perception"], regex: ".*" }
      SP_LABEL:
        { keywords: ["stakeholder_perception"], regex: "(?i)(VL|L|M|H|VH)" }
      SP_REASON: { keywords: ["stakeholder_perception"], regex: ".*" }
      SC_LABEL: { keywords: ["social_capital"], regex: "(?i)(VL|L|M|H|VH)" }
      SC_REASON: { keywords: ["social_capital"], regex: ".*" }
      PA_LABEL: { keywords: ["place_attachment"], regex: "(?i)(VL|L|M|H|VH)" }
      PA_REASON: { keywords: ["place_attachment"], regex: ".*" }

household_renter:
  description: "Renters."
  prompt_template: |
    You are a renter (Agent ID: {agent_id}).
    You have lived here for {residency_generations} years. Your income is {income_range}.

    Experience: {flood_experience_summary} | Memory: {memory}
    Insurance: You Currently {insurance_status} flood insurance.

    Criteria to consider:
    {criteria_definitions}

    Options:
    {options_text}

    {universal_format}

  parsing:
    decision_keywords: ["decision"]
    default_skill: "do_nothing"
    full_disclosure: true
    strict_mode: true
    skill_map:
      "1": "do_nothing"
      "2": "buy_contents_insurance"
      "3": "relocate"
    constructs:
      TP_LABEL: { keywords: ["threat_perception"], regex: "(?i)(VL|L|M|H|VH)" }
      CP_LABEL: { keywords: ["coping_perception"], regex: "(?i)(VL|L|M|H|VH)" }
      SP_LABEL:
        { keywords: ["stakeholder_perception"], regex: "(?i)(VL|L|M|H|VH)" }
      SC_LABEL: { keywords: ["social_capital"], regex: "(?i)(VL|L|M|H|VH)" }
      PA_LABEL: { keywords: ["place_attachment"], regex: "(?i)(VL|L|M|H|VH)" }

government:
  description: "Gov Agency."
  prompt_template: |
    You are the State Government Agency. Year: {year}.
    Stats: Subsidy Rate: {subsidy_rate:.0%} | Elevated: {elevated_count}/{total_households}
    Task: 1:INCREASE | 2:DECREASE | 3:MAINTAIN

    Respond only with this JSON format:
    <<<DECISION_START>>>
    {{
      "decision": 3,
      "reasoning": "..."
    }}
    <<<DECISION_END>>>
  parsing:
    decision_keywords: ["decision"]
    default_skill: "maintain_subsidy"
    skill_map:
      {
        "1": "increase_subsidy",
        "2": "decrease_subsidy",
        "3": "maintain_subsidy",
      }

insurance:
  description: "Insurer."
  prompt_template: |
    You are a Regional Insurance Marketer.
    Stats: Loss Ratio: {loss_ratio:.2f} | Insured Base: {insured_count}
    Task: 1:RAISE | 2:LOWER | 3:MAINTAIN

    Respond only with this JSON format:
    <<<DECISION_START>>>
    {{
      "decision": 3,
      "reasoning": "..."
    }}
    <<<DECISION_END>>>
  parsing:
    decision_keywords: ["decision"]
    default_skill: "maintain_premium"
    skill_map:
      { "1": "raise_premium", "2": "lower_premium", "3": "maintain_premium" }

governance:
  strict:
    household_owner:
      identity_rules:
        - {
            id: elevated_already,
            precondition: elevated,
            blocked_skills: ["elevate_house"],
            level: ERROR,
          }
        - {
            id: relocated_already,
            precondition: relocated,
            blocked_skills:
              ["buy_insurance", "elevate_house", "buyout_program"],
            level: ERROR,
          }
      thinking_rules:
        - {
            construct: TP_LABEL,
            when_above: ["VH"],
            blocked_skills: ["do_nothing"],
            level: ERROR,
          }
        - {
            construct: CP_LABEL,
            when_above: ["VL"],
            blocked_skills: ["elevate_house", "buyout_program"],
            level: ERROR,
          }
    household_renter:
      identity_rules:
        - {
            id: relocated_already,
            precondition: relocated,
            blocked_skills: ["buy_contents_insurance", "relocate"],
            level: ERROR,
          }

metadata: { version: "v20-plain-narrative-aligned" }
